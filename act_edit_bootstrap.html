<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    
    <title>WushuMushu Edit</title>
    
    <!-- Bootstrap core CSS -->
    <link href="bootstrap-3.1.1-dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="bootstrap-3.1.1-dist/css/bootstrap-theme.min.css" rel="stylesheet">
    
    <!-- Custom styles for this template -->
    <link href="theme.css" rel="stylesheet">
    
    <!-- Stylesheet for impromptu -->
    <link href="impromptu.css" rel="stylesheet">

    </head>
    
    <body role="document">
        
        <div class="container panel-container" role="main">
            
            <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
                <div class="container-fluid">
                    <!-- Brand and toggle get grouped for better mobile display -->
                    <ul class="nav navbar-nav navbar-left">
                        <ol class="breadcrumb list inline">
                          <li><a href="#">Show</a></li>
                          <li><a href="#">Act</a></li>
                          <li class="active">Current Section</li><!-- or could be Edit -->
                        </ol>
                    </ul>
            
                    <ul class="nav navbar-nav navbar-right">
                        <div class="btn-group">
                          <button type="button" class="btn btn-default">Edit</button>
                          <button type="button" class="btn btn-default">View</button>
                        </div>
                    </ul>
              
                </div><!--container-fluid -->
            </nav>
            
            <div class="row" id="song-pane">
                <div class="col-sm-7">
                    
                    <!-- Reference: view-source:http://labs.abeautifulsite.net/demos/bootstrap-file-inputs/ -->
                    <div class="input-group" style="padding-bottom:2em;">
                        <span class="input-group-btn">
                            <span class="btn btn-default btn-file">
                                Add Song<input type="file" multiple>
                            </span>
                        </span>
                        <input type="text" class="form-control" readonly>
                    </div>
                    
                </div>
            </div>
            
            <div class="row" id="main-pane">

                <!-- Sections -->
                <div class="col-sm-3">
                    <div class="panel panel-default">
                      <div class="panel-heading">Sections</div>
                    
                      <!-- List group -->
                      <ul class="list-group">
                        <li class="list-group-item">Section 1</li>
                        <li class="list-group-item">Section 2</li>
                      </ul>
                    
                     
                      <div class="input-group">
                          <input type="text" class="form-control">
                          <span class="input-group-btn">
                            <button class="btn btn-default" type="button">Add</button>
                          </span>      
                      </div>
                   
                        
                    </div>
                </div>
                
                <!-- Moves container -->
                <div class="col-sm-4">
                    <div class="panel panel-default">
                      <div class="panel-heading">Moves</div>
                    
                      <!-- List group -->
                      <ul class="list-group">
                        <li class="list-group-item">Move 1</li>
                        <li class="list-group-item">Move 2</li>
                      </ul>
                    
                      <form class="form-horizontal" role="form">
                          <div class="form-group">
                            <div class="col-sm-12">
                                <label class="sr-only" for="add-move">Add Move</label>
                                <textarea class="form-control" id="add-move" rows="3"></textarea>
                            </div>
                          </div>
                          
                          <div class="form-group">
                            <div class="col-sm-offset-5">
                                <button type="submit" class="btn btn-default">Add</button>
                            </div>
                          </div>
                      </form>
                        
                    </div>
                </div>
                
                <!-- Right side of the panel -->

                <div class="col-sm-5">
                    <!-- Weapons Group Buttons -->
                    <div class="btn-group btn-group-justified" id = "weaponList">
		      <div class = "btn-group" id = "edit-weapon-btn">

			<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			  Edit <span class="caret"></span>
			</button>
			<ul class="dropdown-menu dropdown-menu-right" role="menu">
			  <li><a id = "new-weapon-button"> New weapon </a></li>
			  <li class="divider"></li>
			  <li><a id = "delete-weapon-button">Delete Weapon</a></li>
                        </ul> 
	              </div>

                    </div>
                    
                    <!-- Add Youtube player here -->
                    <div class="" style="padding-top:2em;">
                        <div class="vid">
                            <iframe width="560" height="315" src="http://www.youtube.com/embed/WzUxxqSMpB0?rel=0" frameborder="0" allowfullscreen></iframe>
                        </div>
                    </div>
                        
                </div><!-- col-sm-6 -->
                
            </div><!-- row -->

   
        </div><!-- panel-container -->
        
        <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="bootstrap-3.1.1-dist/js/bootstrap.min.js"></script>
    <script src="bootstrap-3.1.1-dist/assets/js/docs.min.js"></script>
    <script src="jquery-1.9.0.min.js"></script>
    <script src="impromptu.min.js"></script>
    <script type = "text/javascript">
      /*
      Data model for GR4:
      Each act has ONE master dictionary that holds all information organized as follows
      Dict[sectionName] -> MoveDict
      MoveDict[moveName] -> TextWeaponTuple
      TextWeaponTuple = [MoveText, WeaponList]
      WeaponList = [(weapon1, videoURL), ... (weaponX, videoURL)]
      */
      var actDictionary = {'section1': {'move1': ['This is the move text to display', {'Sword': null, 'Staff': null, 'Fist': null}], 
                                        'move2': null},
                           'section2': null};
      var currentSection = 'section1';
      var currentMove = 'move1';
      var currentWeapon = 'sword';
      var currentVideo = 'null';
      $(document).ready(function() {
          $.each(actDictionary[currentSection][currentMove][1], function(key, value) {
                 console.log(key);
                 var newIDString = key + "-weapon-btn";
                 var newButton = jQuery('<div/>', {id: newIDString,
                                        class: 'btn-group'}).html('<button type="button" class="btn btn-default weapon-btn">'+
                                    key + '</button>');
                 $('#edit-weapon-btn').before(newButton);

              
          }); 
      });

      /*Weapons group handling */
      $('#new-weapon-button').click( function(e) {
         console.log("NTHNSTH");
         var newWeapon = null;
         var newWeaponPrompt = {
                state0: {
		    title: 'New Weapon',
                    html:'<label>Weapon Name <input type="text" name="fname" value=""></label><br />',
                    buttons: { Cancel: -1, Done: 1 },
                    focus: 1,
                    submit:function(e,v,m,f){ 
			console.log(f.fname);
                        newWeapon = f.fname
                        if (f.fname != "") {      
                            var newButton = jQuery('<div/>', {id: f.fname, 
                                             class: 'btn-group'}).html('<button type="button" class="btn btn-default weapon-btn" id=newWeapon+ "-weapon-btn">'+
	                                     f.fname + '</button>');
                            $('#edit-weapon-btn').before(newButton);
                            actDictionary[currentSection][currentMove][1][f.fname]= null;
                            currentWeapon = f.fname;
                            currentVideo = null;
   
                        }
			e.preventDefault();
                        if(v==-1) $.prompt.close();
                        if(v==1) $.prompt.close();
                    },
            },
  	};
        $.prompt(newWeaponPrompt);
      });
      

      $('#delete-weapon-button').click( function(e) {
      var currentWeaponList = Object.keys(actDictionary[currentSection][currentMove][1]);
      var selectForm = $("<select></select>");
      console.log(selectForm);
      $.each(actDictionary[currentSection][currentMove][1], function(key, value) {
        console.log(selectForm);
        selectForm.append($("<option></option>").attr("value",key).text(key));
      });
      console.log(selectForm.html());
      var deleteWeaponPrompt = {
                state0: {
		    title: 'Delete Weapon',
                    html: "<select name = 'dname' id = 'delete-weapon-select'>" + selectForm.html() + "</select>",
                    buttons: { Cancel: -1, Done: 1 },
                    focus: 1,
                    submit:function(e,v,m,f){ 
			console.log(f.dname);
                            delete actDictionary[currentSection][currentMove][1][f.dname];
                            $("#"+f.dname + "-weapon-btn").remove();
                            currentWeapon = null;
                            currentVideo = null;
   
                        
			e.preventDefault();
                        if(v==-1) $.prompt.close();
                        if(v==1) $.prompt.close();
                    },
            },
  	};
        $.prompt(deleteWeaponPrompt);
        $.each(actDictionary[currentSection][currentMove][1], function(key, value) {
          jQuery('<div/>', {value: key}).html("<option value='"+key+"'>" + key + "</option>").appendTo("#delete-select");
        });
      });
    </script>
 
    </body>
    
</html>
      
    
